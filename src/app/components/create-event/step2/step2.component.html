<div class="content pFocusTrap mt-5">
  <div class="p-fluid">
    <!-- Date and Time Field -->
    <div class="field">
      <p-floatLabel>
        <p-calendar
          #dateAndTimeInput="ngModel"
          [(ngModel)]="dateAndTime"
          [showTime]="true"
          [hourFormat]="'24'"
          [showIcon]="true"
          [showOnFocus]="true"
          [minDate]="minDate"
          required
          id="date"
          [ngClass]="{
            'ng-invalid ng-dirty':
              (dateAndTimeInput.invalid && submitted) ||
              (dateAndTimeInput.dirty && dateAndTimeInput.invalid)
          }"
        >
          <ng-template pTemplate="inputicon" let-clickCallBack="clickCallBack">
            <rmx-icon
              style="width: 16px; height: 16px"
              name="calendar-line"
              (click)="clickCallBack($event)"
            >
            </rmx-icon>
          </ng-template>
        </p-calendar>
        <label for="date">Date and Time</label>
      </p-floatLabel>
      <small
        *ngIf="(dateAndTimeInput.invalid && submitted) || (dateAndTimeInput.dirty && dateAndTimeInput.invalid)"
        class="p-error"
      >
        Date and time are required.
      </small>
    </div>

    <!-- Address Section -->
    <h2>Address</h2>
    <div class="field">
      <p-checkbox
        name="online"
        label="Online-Event"
        [(ngModel)]="online"
        [binary]="true"
        id="online-true"
        variant="filled"
      >
      </p-checkbox>
    </div>

    <div class="p-grid">
      <div class="p-col-12 p-md-6 field">
        <p-floatLabel>
          <input
            #streetInput="ngModel"
            pInputText
            id="street"
            [(ngModel)]="street"
            [disabled]="online"
            [required]="!online"
            [ngClass]="{
              'ng-invalid ng-dirty':
                (!online && streetInput.invalid && submitted) ||
                (streetInput.dirty && streetInput.invalid)
            }"
          />
          <label for="street">Street</label>
        </p-floatLabel>
        <small
          *ngIf="(!online && streetInput.invalid && submitted) || (streetInput.dirty && streetInput.invalid)"
          class="p-error"
        >
          Street is required.
        </small>
      </div>
      <div class="p-col-12 p-md-6 field">
        <p-floatLabel>
          <input
            #streetNumberInput="ngModel"
            pInputText
            id="streetNumber"
            [(ngModel)]="streetNumber"
            [disabled]="online"
            [required]="!online"
            [ngClass]="{
              'ng-invalid ng-dirty':
                (!online && streetNumberInput.invalid && submitted) ||
                (streetNumberInput.dirty && streetNumberInput.invalid)
            }"
          />
          <label for="streetNumber">Street Number</label>
        </p-floatLabel>
        <small
          *ngIf="(!online && streetNumberInput.invalid && submitted) || (streetNumberInput.dirty && streetNumberInput.invalid)"
          class="p-error"
        >
          Street number is required.
        </small>
      </div>
    </div>

    <!-- ZIP Code and City -->
    <div class="p-grid">
      <div class="p-col-12 p-md-6 field">
        <p-floatLabel>
          <input
            #zipCodeInput="ngModel"
            pInputText
            id="zipCode"
            [(ngModel)]="zipCode"
            [disabled]="online"
            [required]="!online"
            [pattern]="!online ? '^[A-Za-z0-9\\-\\s]{4,10}$' : ''"
            [ngClass]="{
            'ng-invalid ng-dirty':
              (!online && (zipCodeInput.invalid || zipCodeInput.errors?.['pattern']) && submitted) ||
              (zipCodeInput.dirty && zipCodeInput.invalid)
            }"
          />
          <label for="zipCode">ZIP Code</label>
        </p-floatLabel>
        <small
          *ngIf="
            (!online && zipCodeInput.errors?.['pattern'] && submitted) ||
            (zipCodeInput.dirty && zipCodeInput.errors?.['pattern'])
          "
          class="p-error"
        >
          Please enter a valid ZIP Code (4â€“10 alphanumeric characters).
        </small>
        <small
          *ngIf="
            (!online && zipCodeInput.invalid && submitted && !zipCodeInput.errors?.['pattern']) ||
            (zipCodeInput.dirty && zipCodeInput.invalid && !zipCodeInput.errors?.['pattern'])
          "
          class="p-error"
        >
          ZIP Code is required.
        </small>
      </div>
      <div class="p-col-12 p-md-6 field">
        <p-floatLabel>
          <input
            #cityInput="ngModel"
            pInputText
            id="city"
            [(ngModel)]="city"
            [disabled]="online"
            [required]="!online"
            [ngClass]="{
              'ng-invalid ng-dirty':
                (!online && cityInput.invalid && submitted) ||
                (cityInput.dirty && cityInput.invalid)
            }"
          />
          <label for="city">City</label>
        </p-floatLabel>
        <small
          *ngIf="(!online && cityInput.invalid && submitted) || (cityInput.dirty && cityInput.invalid)"
          class="p-error"
        >
          City is required.
        </small>
      </div>
    </div>
  </div>

  <!-- Navigation Buttons -->
  <div class="content fixed-bottom-responsive-container">
    <div class="content button-wrapper p-grid p-nogutter">
      <div class="p-col-6 p-md-3">
        <p-button
          [raised]="true"
          label="Back"
          (onClick)="prevPage()">
          <ng-template pTemplate="icon">
            <rmx-icon
              class="mr-2"
              style="width: 16px; height: 16px"
              name="arrow-left-circle-line">
            </rmx-icon>
          </ng-template>
        </p-button>
      </div>
      <div class="p-col-6 p-md-3">
        <p-button
          [raised]="true"
          severity="secondary"
          label="Continue"
          (onClick)="nextPage()">
          <ng-template pTemplate="icon">
            <rmx-icon
              class="mr-2"
              style="width: 16px; height: 16px"
              name="arrow-right-circle-line">
            </rmx-icon>
          </ng-template>
        </p-button>
      </div>
    </div>
  </div>
</div>


<p-confirmDialog>
  <ng-template pTemplate="message" let-message>
    <div class="flex flex-column align-items-center w-full gap-3 border-bottom-1 surface-border">
      <i class="pi pi-exclamation-circle text-6xl text-primary-500"></i>
      <p>{{ message.message }}</p>
    </div>
  </ng-template>
</p-confirmDialog>
