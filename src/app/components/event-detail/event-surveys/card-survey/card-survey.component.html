<div>
    <p-card
            class="p-3 cursor-pointer"
            [ngClass]="{ 'p-0': survey.title }"
            (click)="toggleExpand()">
        <div class="flex align-items-center pr-3">
            <div class="flex flex-column ml-3 flex-grow-1">
                <div>
                    <h3 class="mt-0 mb-0">
                        <span>{{ survey.title }}</span>
                    </h3>
                    <p class="text-secondary mt-0 mb-0">{{ survey.description }}</p>
                </div>
            </div>
            <!-- Wechsel der Pfeil-Icons -->
            <rmx-icon
                    [name]="expanded ? 'arrow-down-s-line' : 'arrow-right-s-line'"
                    style="height: 26px; width: 26px"
                    class="">
            </rmx-icon>
        </div>
    </p-card>

    <!-- Ausklappbarer Bereich -->
    @if (expanded) {
        <div class="mt-3">
            @if (surveyDetail$ | async; as surveyDetail) {
                <ng-container>
                    <!-- Umfrage-Optionen -->
                    @for(entry of surveyDetail.surveyEntries; track $index){
                        <div  class="mb-3">
                            <div class="flex align-items-center">
                                <div class="avatar-group mr-2">
                                    @for(user of entry.users; track $index){
                                        <ng-container>
                                            <p-avatar
                                                    [image]="'assets/profile/' + user.profilePicture"
                                                    [label]="user.firstName.charAt(0)"
                                                    shape="circle"
                                                    size="normal"
                                            >
                                            </p-avatar>
                                        </ng-container>
                                    }
                                </div>
                                <!-- Option Name und Progress Bar -->
                                <div class="flex-grow-1">
                                    <p>{{ entry.content }}</p>
                                    <p-progressBar
                                            [value]="entry.users.length * 10"
                                            styleClass="mt-1"
                                            >
                                    </p-progressBar>
                                </div>
                                <!-- Anzahl der Stimmen -->
                                <span class="ml-2">{{ entry.users.length }}</span>
                            </div>
                        </div>
                    }

                </ng-container>
            } @else {
                <p>loading...</p>
            }
        </div>
    }
</div>
