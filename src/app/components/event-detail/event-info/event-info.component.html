<p-dialog
  [(visible)]="notLoggedInDialogVisible"
  contentStyleClass="border-round"
  [showHeader]="false"
  [draggable]="false"
  [focusOnShow]="false"
  modal
  [closeOnEscape]="false"
  [closable]="false"
  [style]="{ width: '25rem' }">
  <div class="py-4">
    @if (loginRegisterSwitch) {
      <app-login
        [redirectTo]="'/event/' + eventId"
        (toggleView)="toggleLoginRegisterSwitch()"
        class="w-full" />
    } @else {
      <app-register (toggleView)="toggleLoginRegisterSwitch()" class="w-full" />
    }
  </div>
</p-dialog>

@if (isLoading) {
  <div class="flex justify-content-center align-items-center mt-8">
    <p-progressSpinner
      styleClass="w-4rem h-4rem"
      strokeWidth="8"
      fill="var(--surface-ground)"
      animationDuration=".5s">
    </p-progressSpinner>
  </div>
} @else {
  <div class="xl:mr-8 p-0 m-0 mb-8 grid justify-content-center">
    <div class="col-12 xl:col-7">
      <div class="flex justify-content-center p-0 sm:p-0 m-0">
        <p-image
          [alt]="'landingPage.headerImageAlt' | transloco"
          src="./images/pexels-elevate-1267254.jpg"
          class="w-full"
          styleClass="w-full"
          imageClass="w-full" />
      </div>
    </div>
    <div class="col-12 xl:col-7">
      <h2>{{ eventDetails.title }}</h2>

      <div class="flex w-full justify-content-between">
        <span> </span>
        <span>
          @for (category of eventDetails.categories; track $index) {
            <p-tag [value]="category.name" [rounded]="true" class="mr-1" />
          }
        </span>
      </div>

      <p-card styleClass="p-mb-3 mt-3">
        <div class="grid">
          <div class="col">
            <div class="flex items-center">
              <rmx-icon name="calendar-line" class="mr-2"></rmx-icon>
              <p class="m-0">
                {{
                  eventDetails.dateAndTime
                    | translocoDate: { dateStyle: 'medium' }
                }}
              </p>
            </div>
            <div class="flex items-center mt-3">
              <rmx-icon name="time-line" class="mr-2"></rmx-icon>
              <p class="m-0">
                {{
                  eventDetails.dateAndTime
                    | translocoDate: { timeStyle: 'short' }
                }}
              </p>
            </div>
          </div>
          <div class="col">
            <div class="flex items-center">
              <rmx-icon name="map-pin-2-line" class="mr-2"></rmx-icon>
              @if (eventDetails.street || eventDetails.streetNumber) {
                <p class="m-0">
                  {{ eventDetails.street }} {{ eventDetails.streetNumber }}
                </p>
              }
              @if (!eventDetails.city) {
                <p class="m-0">Online-Event</p>
              }
            </div>
            @if (eventDetails.city) {
              <p class="m-0 ml-5">
                {{ eventDetails.zipCode }} {{ eventDetails.city }}
              </p>
            }
          </div>
        </div>
        <h3>{{ 'eventDetailPageComponent.eventDetails' | transloco }}</h3>
        <p>{{ eventDetails.description }}</p>
        <div>
          <p-tag
            severity="secondary"
            value="Secondary"
            [rounded]="true"
            class="mr-1" />
          <p-tag
            severity="secondary"
            value="Secondary"
            [rounded]="true"
            class="mr-1" />
          <p-tag
            severity="secondary"
            value="Secondary"
            [rounded]="true"
            class="mr-1" />
        </div>
      </p-card>
      @if (
        eventDetails.startAge ||
        eventDetails.endAge ||
        eventDetails.preferredGenders.length > 0
      ) {
        <p class="p-1"></p>
        <p-card styleClass="p-mb-3">
          <h3>{{ 'eventDetailPageComponent.restrictions' | transloco }}</h3>
          <div class="grid">
            <div class="col">
              @if (eventDetails.preferredGenders.length > 0) {
                <p class="pb-3 color-secondary">
                  {{ 'eventDetailPageComponent.gender' | transloco }}
                </p>
              }
              @if (eventDetails.startAge || eventDetails.endAge) {
                <p class="color-secondary">
                  {{ 'eventDetailPageComponent.age' | transloco }}
                </p>
              }
            </div>
            <div class="col">
              @if (eventDetails.preferredGenders.length > 0) {
                <p class="pb-3">
                  {{ getPreferredGendersString(eventDetails.preferredGenders) }}
                </p>
              }
              <p>
                {{
                  eventDetails.startAge
                    ? ('eventDetailPageComponent.from' | transloco) +
                      ' ' +
                      eventDetails.startAge +
                      ' ' +
                      ('eventDetailPageComponent.years1' | transloco)
                    : ''
                }}
              </p>
              <p>
                {{
                  eventDetails.endAge
                    ? ('eventDetailPageComponent.to' | transloco) +
                      ' ' +
                      eventDetails.endAge +
                      ' ' +
                      ('eventDetailPageComponent.years2' | transloco)
                    : ''
                }}
              </p>
            </div>
          </div>
        </p-card>
      }
    </div>
    <div class="mt-3 col-12 lg:col-fixed lg:w-max">
      <div class="flex justify-content-end md:flex-none xl:fixed">
        <p-button class="mr-2" [raised]="true" severity="info">
          <ng-template pTemplate="icon">
            <rmx-icon
              style="width: 16px; height: 16px"
              name="heart-3-line"></rmx-icon>
          </ng-template>
        </p-button>
        <p-button
          [raised]="true"
          [label]="
            eventDetails.type === 1
              ? ('eventDetailPageComponent.join' | transloco)
              : eventDetails.type === 2
                ? ('eventDetailPageComponent.request' | transloco)
                : ('eventDetailPageComponent.privateEvent' | transloco)
          "
          [disabled]="eventDetails.type === 3"
          severity="success"
          (click)="handleButtonClick(eventDetails.type)">
        </p-button>
      </div>
    </div>
    <div class="xl:col-5"></div>
  </div>
}
